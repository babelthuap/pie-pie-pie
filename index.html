<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RAGBRAI Pie Tracker</title>
    <!-- Tailwind CSS for modern styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      body {
        font-family:
          ui-sans-serif,
          system-ui,
          -apple-system,
          BlinkMacSystemFont,
          "Segoe UI",
          Roboto,
          "Helvetica Neue",
          Arial,
          "Noto Sans",
          sans-serif,
          "Apple Color Emoji",
          "Segoe UI Emoji",
          "Segoe UI Symbol",
          "Noto Color Emoji";
        background-color: #fce7f3; /* Light pink background */
      }
      .pie-slice {
        display: inline-block;
        animation: spin 1s linear infinite;
      }
      @keyframes spin {
        from {
          transform: rotate(0deg);
        }
        to {
          transform: rotate(360deg);
        }
      }
      .text-shadow-custom {
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
      }
    </style>
  </head>
  <body class="flex items-center justify-center min-h-screen p-4">
    <div
      class="bg-white p-8 sm:p-12 rounded-3xl shadow-2xl border-4 border-pink-400 max-w-lg w-full text-center transform transition-transform duration-300 hover:scale-105"
    >
      <h1 class="text-4xl sm:text-5xl font-bold text-pink-600 mb-4 text-shadow-custom">
        RAGBRAI Pie Tracker <span role="img" aria-label="pie">&#x1F967;</span>
      </h1>
      <p class="text-lg text-gray-700 mb-8 font-medium">
        How many slices of heaven have you consumed?
      </p>

      <!-- Pie Counter Display -->
      <div id="counterContainer">
        <div
          id="pieCount"
          class="text-7xl sm:text-8xl font-extrabold text-pink-500 mb-6 transition-all duration-500"
        >
          0
        </div>

        <!-- Action Buttons -->
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <button
            id="eatPieBtn"
            class="bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 px-6 rounded-full shadow-lg transform transition-transform duration-150 hover:scale-105 active:scale-95"
          >
            Eat a Pie <span class="pie-slice">&#x1F967;</span>
          </button>
          <button
            id="resetBtn"
            class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-3 px-6 rounded-full shadow-lg transform transition-transform duration-150 hover:scale-105 active:scale-95"
          >
            Reset
          </button>
        </div>
      </div>

      <!-- Custom Modal for Alerts -->
      <div
        id="customModal"
        class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full"
      >
        <div
          class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white text-center"
        >
          <div class="mt-3 text-center">
            <h3 class="text-lg leading-6 font-medium text-gray-900" id="modalTitle"></h3>
            <div class="mt-2 px-7 py-3">
              <p class="text-sm text-gray-500" id="modalMessage"></p>
            </div>
            <div class="items-center px-4 py-3">
              <button
                id="modalOkBtn"
                class="px-4 py-2 bg-pink-500 text-white text-base font-medium rounded-md w-full shadow-sm hover:bg-pink-600 focus:outline-none focus:ring-2 focus:ring-pink-300"
              >
                OK
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- JavaScript for functionality -->
    <script>
      // Get elements from the DOM
      const pieCountDisplay = document.getElementById("pieCount");
      const eatPieBtn = document.getElementById("eatPieBtn");
      const resetBtn = document.getElementById("resetBtn");

      // Key for localStorage
      const PIE_COUNT_KEY = "ragbraiPieCount";

      // Function to load pie count from localStorage
      function loadPieCount() {
        const storedCount = localStorage.getItem(PIE_COUNT_KEY);
        // If a count exists, parse it as an integer, otherwise default to 0
        const count = storedCount ? parseInt(storedCount, 10) : 0;
        pieCountDisplay.innerText = count;
      }

      // Function to save pie count to localStorage
      function savePieCount(count) {
        localStorage.setItem(PIE_COUNT_KEY, count);
      }

      // Event listener for eating a pie
      eatPieBtn.addEventListener("click", () => {
        let currentCount = parseInt(pieCountDisplay.innerText, 10);
        currentCount++;
        pieCountDisplay.innerText = currentCount;
        savePieCount(currentCount);
      });

      // Event listener for resetting the count
      resetBtn.addEventListener("click", () => {
        pieCountDisplay.innerText = 0;
        savePieCount(0);
      });

      // Load the pie count when the page loads
      document.addEventListener("DOMContentLoaded", loadPieCount);
    </script>
  </body>
</html>
